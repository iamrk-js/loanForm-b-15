<div class="container my-5">
    <div class="row">
      <div class="col-12">
        <mat-horizontal-stepper linear>
          <!-- Step 1: Personal Details -->
          <mat-step [stepControl]="personalDetailsForm">
            <form [formGroup]="personalDetailsForm">
              <ng-template matStepLabel>Personal Details</ng-template>
  
              <!-- Name -->
              <mat-form-field appearance="fill">
                <mat-label>Name</mat-label>
                <input matInput formControlName="name" required />
                <mat-error
                  *ngIf="personalDetailsForm.get('name')?.hasError('required')"
                >
                  Name is required.
                </mat-error>
                <mat-error
                  *ngIf="personalDetailsForm.get('name')?.hasError('minlength')"
                >
                  Minimum 3 characters required.
                </mat-error>
              </mat-form-field>
  
              <!-- Email -->
              <mat-form-field appearance="fill">
                <mat-label>Email</mat-label>
                <input matInput formControlName="email" required />
                <mat-error
                  *ngIf="personalDetailsForm.get('email')?.hasError('required')"
                >
                  Email is required.
                </mat-error>
                <mat-error
                  *ngIf="personalDetailsForm.get('email')?.hasError('email')"
                >
                  Invalid email format.
                </mat-error>
              </mat-form-field>
  
              <!-- Phone -->
              <mat-form-field appearance="fill">
                <mat-label>Phone</mat-label>
                <input matInput formControlName="phone" required />
                <mat-error
                  *ngIf="personalDetailsForm.get('phone')?.hasError('required')"
                >
                  Phone is required.
                </mat-error>
                <mat-error
                  *ngIf="
                    personalDetailsForm
                      .get('phone')
                      ?.hasError('invalidPhoneNumber')
                  "
                >
                  Invalid phone number (10 digits starting with 6-9).
                </mat-error>
              </mat-form-field>
  
              <!-- Date of Birth -->
              <mat-form-field appearance="fill">
                <mat-label>Date of Birth</mat-label>
                <input
                  matInput
                  [matDatepicker]="dobPicker"
                  formControlName="dob"
                  required
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="dobPicker"
                ></mat-datepicker-toggle>
                <mat-datepicker #dobPicker></mat-datepicker>
                <mat-error
                  *ngIf="personalDetailsForm.get('dob')?.hasError('required')"
                >
                  Date of Birth is required.
                </mat-error>
                <mat-error
                  *ngIf="
                    personalDetailsForm.get('dob')?.hasError('invalidDateOfBirth')
                  "
                >
                  You must be at least 21 years old.
                </mat-error>
              </mat-form-field>
  
              <!-- Gender -->
              <mat-form-field appearance="fill">
                <mat-label>Gender</mat-label>
                <mat-select formControlName="gender" required>
                  <mat-option value="male">Male</mat-option>
                  <mat-option value="female">Female</mat-option>
                  <mat-option value="other">Other</mat-option>
                </mat-select>
                <mat-error
                  *ngIf="personalDetailsForm.get('gender')?.hasError('required')"
                >
                  Gender is required.
                </mat-error>
              </mat-form-field>
  
              <!-- Marital Status -->
              <mat-form-field appearance="fill">
                <mat-label>Marital Status</mat-label>
                <mat-select formControlName="maritalStatus" required>
                  <mat-option value="single">Single</mat-option>
                  <mat-option value="married">Married</mat-option>
                  <mat-option value="divorced">Divorced</mat-option>
                </mat-select>
                <mat-error
                  *ngIf="
                    personalDetailsForm.get('maritalStatus')?.hasError('required')
                  "
                >
                  Marital Status is required.
                </mat-error>
              </mat-form-field>
  
              <div>
                <button mat-button matStepperNext type="button">Next</button>
              </div>
            </form>
          </mat-step>
  
          <!-- Step 2: Document Upload -->
          <mat-step [stepControl]="documentUploadForm">
            <form [formGroup]="documentUploadForm">
              <ng-template matStepLabel>Document Upload</ng-template>
  
              <!-- PAN Card -->
              <mat-form-field appearance="fill">
                <mat-label>PAN Card</mat-label>
                <input matInput formControlName="pan" required />
                <mat-error
                  *ngIf="documentUploadForm.get('pan')?.hasError('required')"
                >
                  PAN card is required.
                </mat-error>
                <mat-error
                  *ngIf="
                    documentUploadForm.get('pan')?.hasError('invalidPanCard')
                  "
                >
                  Invalid PAN format (e.g., AAAAA9999A).
                </mat-error>
              </mat-form-field>
  
              <!-- Aadhar Card -->
              <mat-form-field appearance="fill">
                <mat-label>Aadhar Card</mat-label>
                <input matInput formControlName="aadhar" required />
                <mat-error
                  *ngIf="documentUploadForm.get('aadhar')?.hasError('required')"
                >
                  Aadhar card is required.
                </mat-error>
                <mat-error
                  *ngIf="
                    documentUploadForm
                      .get('aadhar')
                      ?.hasError('invalidAadharCard')
                  "
                >
                  Aadhar must be 12 digits.
                </mat-error>
              </mat-form-field>
  
              <div>
                <button mat-button matStepperPrevious type="button">Back</button>
                <button mat-button matStepperNext type="button">Next</button>
              </div>
            </form>
          </mat-step>
  
          <!-- Step 3: Address Details -->
          <!-- Step 3: Address Details -->
          <mat-step [stepControl]="addressDetailsForm">
            <form [formGroup]="addressDetailsForm">
              <ng-template matStepLabel>Address Details</ng-template>
  
              <!-- Permanent Address -->
              <h3>Permanent Address</h3>
              <div formGroupName="permanentAddress">
                <mat-form-field appearance="fill">
                  <mat-label>Address Line 1</mat-label>
                  <input matInput formControlName="addressLine1" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('permanentAddress.addressLine1')
                        ?.hasError('required')
                    "
                  >
                    Address Line 1 is required.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>Address Line 2</mat-label>
                  <input matInput formControlName="addressLine2" />
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>City</mat-label>
                  <input matInput formControlName="city" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('permanentAddress.city')
                        ?.hasError('required')
                    "
                  >
                    City is required.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>State</mat-label>
                  <input matInput formControlName="state" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('permanentAddress.state')
                        ?.hasError('required')
                    "
                  >
                    State is required.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>Pincode</mat-label>
                  <input matInput formControlName="pincode" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('permanentAddress.pincode')
                        ?.hasError('required')
                    "
                  >
                    Pincode is required.
                  </mat-error>
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('permanentAddress.pincode')
                        ?.hasError('pattern')
                    "
                  >
                    Pincode must be 6 digits.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>Country</mat-label>
                  <input matInput formControlName="country" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('permanentAddress.country')
                        ?.hasError('required')
                    "
                  >
                    Country is required.
                  </mat-error>
                </mat-form-field>
              </div>
  
              <!-- Current Address -->
              <h3>Current Address</h3>
              <!-- <mat-checkbox
                formControlName="sameAsPermanent"
                (change)="onSameAsPermanentChange()"
              >
                Same as Permanent Address
              </mat-checkbox> -->
  
              <div formGroupName="currentAddress">
                <mat-form-field appearance="fill">
                  <mat-label>Address Line 1</mat-label>
                  <input matInput formControlName="addressLine1" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('currentAddress.addressLine1')
                        ?.hasError('required')
                    "
                  >
                    Address Line 1 is required.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>Address Line 2</mat-label>
                  <input matInput formControlName="addressLine2" />
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>City</mat-label>
                  <input matInput formControlName="city" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('currentAddress.city')
                        ?.hasError('required')
                    "
                  >
                    City is required.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>State</mat-label>
                  <input matInput formControlName="state" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('currentAddress.state')
                        ?.hasError('required')
                    "
                  >
                    State is required.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>Pincode</mat-label>
                  <input matInput formControlName="pincode" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('currentAddress.pincode')
                        ?.hasError('required')
                    "
                  >
                    Pincode is required.
                  </mat-error>
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('currentAddress.pincode')
                        ?.hasError('pattern')
                    "
                  >
                    Pincode must be 6 digits.
                  </mat-error>
                </mat-form-field>
  
                <mat-form-field appearance="fill">
                  <mat-label>Country</mat-label>
                  <input matInput formControlName="country" required />
                  <mat-error
                    *ngIf="
                      addressDetailsForm
                        .get('currentAddress.country')
                        ?.hasError('required')
                    "
                  >
                    Country is required.
                  </mat-error>
                </mat-form-field>
              </div>
  
              <div>
                <button mat-button matStepperPrevious type="button">Back</button>
                <button mat-button matStepperNext type="button">Next</button>
              </div>
            </form>
          </mat-step>
  
          <!-- Step 4: Employment Details -->
          <mat-step [stepControl]="employmentDetailsForm">
            <form [formGroup]="employmentDetailsForm">
              <ng-template matStepLabel>Employment Details</ng-template>
  
              <!-- Employment Type -->
              <mat-form-field appearance="fill">
                <mat-label>Employment Type</mat-label>
                <mat-select formControlName="employmentType" required>
                  <mat-option
                    *ngFor="let type of employmentTypes"
                    [value]="type"
                    >{{ type }}</mat-option
                  >
                </mat-select>
                <mat-error
                  *ngIf="
                    employmentDetailsForm
                      .get('employmentType')
                      ?.hasError('required')
                  "
                >
                  Employment Type is required.
                </mat-error>
              </mat-form-field>
  
              <!-- Current Income -->
              <mat-form-field appearance="fill">
                <mat-label>Current Income (₹)</mat-label>
                <input
                  matInput
                  formControlName="currentIncome"
                  type="number"
                  required
                />
                <mat-error
                  *ngIf="
                    employmentDetailsForm
                      .get('currentIncome')
                      ?.hasError('required')
                  "
                >
                  Current Income is required.
                </mat-error>
                <mat-error
                  *ngIf="
                    employmentDetailsForm.get('currentIncome')?.hasError('min')
                  "
                >
                  Income must be positive.
                </mat-error>
              </mat-form-field>
  
              <!-- Company Name -->
              <mat-form-field appearance="fill">
                <mat-label>Company Name</mat-label>
                <input matInput formControlName="companyName" required />
                <mat-error
                  *ngIf="
                    employmentDetailsForm.get('companyName')?.hasError('required')
                  "
                >
                  Company Name is required.
                </mat-error>
              </mat-form-field>
  
              <!-- Designation -->
              <mat-form-field appearance="fill">
                <mat-label>Designation</mat-label>
                <input matInput formControlName="designation" required />
                <mat-error
                  *ngIf="
                    employmentDetailsForm.get('designation')?.hasError('required')
                  "
                >
                  Designation is required.
                </mat-error>
              </mat-form-field>
  
              <div>
                <button mat-button matStepperPrevious type="button">Back</button>
                <button mat-button matStepperNext type="button">Next</button>
              </div>
            </form>
          </mat-step>
  
          <!-- Step 5: Loan Details -->
          <mat-step [stepControl]="loanDetailsForm">
            <form [formGroup]="loanDetailsForm">
              <ng-template matStepLabel>Loan Details</ng-template>
  
              <!-- Loan Amount -->
              <mat-form-field appearance="fill">
                <mat-label>Loan Amount (₹)</mat-label>
                <input
                  matInput
                  formControlName="loanAmount"
                  type="number"
                  required
                />
                <mat-error
                  *ngIf="loanDetailsForm.get('loanAmount')?.hasError('required')"
                >
                  Loan Amount is required.
                </mat-error>
                <mat-error
                  *ngIf="
                    loanDetailsForm
                      .get('loanAmount')
                      ?.hasError('invalidLoanAmount')
                  "
                >
                  Amount must be between ₹10,000 and ₹1,00,00,000.
                </mat-error>
              </mat-form-field>
  
              <!-- Loan Tenure -->
              <mat-form-field appearance="fill">
                <mat-label>Loan Tenure (months)</mat-label>
                <input
                  matInput
                  formControlName="loanTenure"
                  type="number"
                  required
                />
                <mat-error
                  *ngIf="loanDetailsForm.get('loanTenure')?.hasError('required')"
                >
                  Loan Tenure is required.
                </mat-error>
                <mat-error
                  *ngIf="
                    loanDetailsForm
                      .get('loanTenure')
                      ?.hasError('invalidLoanTenure')
                  "
                >
                  Tenure must be 6-60 months.
                </mat-error>
              </mat-form-field>
  
              <!-- Loan Purpose -->
              <mat-form-field appearance="fill">
                <mat-label>Loan Purpose</mat-label>
                <mat-select formControlName="loanPurpose" required>
                  <mat-option
                    *ngFor="let purpose of loanPurposes"
                    [value]="purpose"
                    >{{ purpose }}</mat-option
                  >
                </mat-select>
                <mat-error
                  *ngIf="loanDetailsForm.get('loanPurpose')?.hasError('required')"
                >
                  Loan Purpose is required.
                </mat-error>
              </mat-form-field>
  
              <!-- Nominee Name -->
              <mat-form-field appearance="fill">
                <mat-label>Nominee Name</mat-label>
                <input matInput formControlName="nomineeName" required />
                <mat-error
                  *ngIf="loanDetailsForm.get('nomineeName')?.hasError('required')"
                >
                  Nominee Name is required.
                </mat-error>
              </mat-form-field>
  
              <!-- Nominee Relationship -->
              <mat-form-field appearance="fill">
                <mat-label>Nominee Relationship</mat-label>
                <mat-select formControlName="nomineeRelationship" required>
                  <mat-option
                    *ngFor="let relationship of relationships"
                    [value]="relationship"
                    >{{ relationship }}</mat-option
                  >
                </mat-select>
                <mat-error
                  *ngIf="
                    loanDetailsForm
                      .get('nomineeRelationship')
                      ?.hasError('required')
                  "
                >
                  Relationship is required.
                </mat-error>
              </mat-form-field>
  
              <div>
                <button mat-button matStepperPrevious type="button">Back</button>
                <button mat-button (click)="onSubmit()" type="button">
                  Submit
                </button>
              </div>
            </form>
          </mat-step>
        </mat-horizontal-stepper>
      </div>
    </div>
  </div>
  